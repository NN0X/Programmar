<!doctype html>
<html>
        <?php 
                $pageTitle = 'Programmar - Catalog';
                $currentPage = 'courses';
                include 'partials/header.php'; 
        ?>
        <body>
                <div class="app-container">
                        <?php include 'partials/sidebar.php'; ?>

                        <main class="main-content">
                                <header>
                                        <div class="header-text">
                                                <h1>Course Catalog</h1>
                                                <p>Find something new to learn today.</p>
                                        </div>
                                        <div class="ram-container">
                                                <span class="ram-icon">âš¡</span>
                                                <span class="ram-count"><?= $ram; ?> RAM</span>
                                        </div>
                                </header>

                                <div class="dashboard-grid">
                                        <?php foreach ($courses as $course): ?>
                                        <div class="card">
                                                <div class="card-header">
                                                        <div class="card-icon">
                                                                <?php
                                                                        $iconMap = ['terminal' => 'ðŸ’»', 'server' => 'âš™ï¸', 'database' => 'ðŸ—„ï¸', 'code' => 'ðŸ“'];
                                                                        echo $iconMap[$course['icon']] ?? 'ðŸ“˜';
                                                                ?>
                                                        </div>
                                                        <?php 
                                                                $isNew = (strtotime($course['created_at']) > strtotime('-30 days'));
                                                        ?>
                                                        <?php if($isNew): ?>
                                                                <span class="badge-new">NEW</span>
                                                        <?php endif; ?>
                                                </div>

                                                <div class="card-body">
                                                        <h3><?= htmlspecialchars($course['title']); ?></h3>
                                                        <p><?= htmlspecialchars($course['description']); ?></p>
                                                </div>

                                                <form action="/start-course" method="POST">
                                                        <input type="hidden" name="csrf_token" value="<?= $_SESSION['csrf_token'] ?>">
                                                        <input type="hidden" name="id" value="<?= $course['id'] ?>">
                                                        <?php if ($ram > 0): ?>
                                                                <?php if($course['completed_lessons'] > 0): ?>
                                                                        <button type="submit" class="btn-continue">Continue</button>
                                                                <?php else: ?>
                                                                        <button type="submit" class="btn-continue" style="background-color: var(--secondary);">Start Course</button>
                                                                <?php endif; ?>
                                                        <?php else: ?>
                                                                <button type="button" class="btn-continue btn-disabled" disabled>Insufficient RAM</button>
                                                        <?php endif; ?>
                                                </form>
                                        </div>
                                        <?php endforeach; ?>
                                </div>
                        </main>
                </div>
        </body>
</html>
