<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Lesson <?= $lessonNumber ?></title>
        <link rel="stylesheet" href="public/styles/main.css">
        <link rel="stylesheet" href="public/styles/dashboard.css">
        <link rel="stylesheet" href="public/styles/lesson.css">

        <script>
                const totalSlides = <?= count($lesson['sublessons']) ?>;
        </script>
        <script src="public/scripts/lesson.js" defer></script>
</head>
<body>
        <div class="app-container">
                <div style="padding: 20px;">
                        <a href="/dashboard" class="back-link">‚Üê Quit Lesson</a>
                </div>

                <div class="lesson-container">
                        <div class="progress-indicator">
                                <?php foreach ($lesson['sublessons'] as $index => $sub): ?>
                                        <div id="dot-<?= $index ?>" class="progress-dot <?= $index === 0 ? 'active' : '' ?>"></div>
                                <?php endforeach; ?>
                        </div>

                        <div class="lesson-header">
                                <h4>Lesson <?= $lessonNumber ?></h4>
                                <h1><?= htmlspecialchars($lesson['title']) ?></h1>
                        </div>

                        <?php foreach ($lesson['sublessons'] as $index => $sub): ?>
                                <div id="slide-<?= $index ?>" class="sublesson-slide <?= $index === 0 ? 'active' : '' ?>" 
                                     data-type="<?= $sub['type'] ?>" 
                                     data-answer="<?= isset($sub['answer']) ? addslashes($sub['answer']) : '' ?>">

                                        <h2><?= htmlspecialchars($sub['title']) ?></h2>

                                        <?php if ($sub['type'] === 'info'): ?>
                                                <p class="lesson-content"><?= nl2br(htmlspecialchars($sub['content'])) ?></p>

                                        <?php else: ?>
                                                <p class="question-text"><?= htmlspecialchars($sub['question']) ?></p>

                                                <div class="quiz-container">
                                                        <?php if ($sub['type'] === 'multiple_choice'): ?>
                                                                <?php foreach ($sub['options'] as $opt): ?>
                                                                        <label class="option-label">
                                                                                <input type="radio" name="q-<?= $index ?>" value="<?= htmlspecialchars($opt) ?>">
                                                                                <?= htmlspecialchars($opt) ?>
                                                                        </label>
                                                                <?php endforeach; ?>

                                                        <?php elseif ($sub['type'] === 'true_false'): ?>
                                                                <label class="option-label">
                                                                        <input type="radio" name="q-<?= $index ?>" value="true"> True
                                                                </label>
                                                                <label class="option-label">
                                                                        <input type="radio" name="q-<?= $index ?>" value="false"> False
                                                                </label>

                                                        <?php elseif ($sub['type'] === 'input'): ?>
                                                                <input type="text" id="input-<?= $index ?>" class="quiz-input" placeholder="Type your answer...">
                                                        <?php endif; ?>
                                                </div>

                                                <div id="feedback-<?= $index ?>" class="feedback-area"></div>
                                        <?php endif; ?>
                                </div>
                        <?php endforeach; ?>

                        <div class="footer-actions">
                                <button id="btn-action" class="btn-large">Continue</button>

                                <form id="complete-form" action="/complete-lesson" method="POST" style="display:none;">
                                        <input type="hidden" name="course_id" value="<?= $_GET['id'] ?>">
                                </form>
                        </div>
                </div>
        </div>
</body>
</html>
